strmode.c is a free library used in lieu of writing many switch statements myself
